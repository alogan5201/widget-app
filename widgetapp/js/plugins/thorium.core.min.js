/*!
 * Thorium Core functions for framework7 projects
 * Version 2.2 November, 2020
 * framework7 v5.x (https://framework7.io) MIT Licensed
 * Copyright 2018-2020 Thorium builder, All Rights Reserved.
*/
String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)},String.prototype.escapeSpecialChars=function(){return this.replace(/[\\]/g,"\\\\").replace(/[\/]/g,"\\/").replace(/[\b]/g,"\\b").replace(/[\f]/g,"\\f").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t").replace(/[\"]/g,'\\"').replace(/\\'/g,"\\'")};var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,o,i,r,a,n,l,u="",c=0;for(e=Base64._utf8_encode(e);c<e.length;)r=(t=e.charCodeAt(c++))>>2,a=(3&t)<<4|(o=e.charCodeAt(c++))>>4,n=(15&o)<<2|(i=e.charCodeAt(c++))>>6,l=63&i,isNaN(o)?n=l=64:isNaN(i)&&(l=64),u=u+this._keyStr.charAt(r)+this._keyStr.charAt(a)+this._keyStr.charAt(n)+this._keyStr.charAt(l);return u},decode:function(e){var t,o,i,r,a,n,l="",u=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");u<e.length;)t=this._keyStr.indexOf(e.charAt(u++))<<2|(r=this._keyStr.indexOf(e.charAt(u++)))>>4,o=(15&r)<<4|(a=this._keyStr.indexOf(e.charAt(u++)))>>2,i=(3&a)<<6|(n=this._keyStr.indexOf(e.charAt(u++))),l+=String.fromCharCode(t),64!=a&&(l+=String.fromCharCode(o)),64!=n&&(l+=String.fromCharCode(i));return l=Base64._utf8_decode(l)},_utf8_encode:function(e){e=e.replace(/rn/g,"n");for(var t="",o=0;o<e.length;o++){var i=e.charCodeAt(o);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t},_utf8_decode:function(e){for(var t="",o=0,i=c1=c2=0;o<e.length;)(i=e.charCodeAt(o))<128?(t+=String.fromCharCode(i),o++):i>191&&i<224?(c2=e.charCodeAt(o+1),t+=String.fromCharCode((31&i)<<6|63&c2),o+=2):(c2=e.charCodeAt(o+1),c3=e.charCodeAt(o+2),t+=String.fromCharCode((15&i)<<12|(63&c2)<<6|63&c3),o+=3);return t}},thoriumCorePlugin={name:"Thorium Builder Core Plugin",bundleid:"com.thoriumbuilder.core",version:"2.0.0",isLoading:!1,httpRoot:"",language:"en",direction:"ltr",emtyResultTemplate:'<h3 class="text-center w-100 pt-2">No Results</h3>',isLocal:function(){return"file:"==window.location.protocol},loadpage:function(e,t,o){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Loading page "+e),o?app.view[0].router.navigate("/"+e+"/?data="+t,{animate:!0,transition:o,reloadAll:!1}):app.view[0].router.navigate("/"+e+"/?data="+t,{animate:!0,reloadAll:!1})},getpageparam:function(e){var t=e.detail.route;if(t)return t.query.data||null},reloadHomePage:function(){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Reloading Home Page "),"/"!=app.view[0].router.url&&app.view[0].router.navigate("/",{animate:!1,reloadAll:!0})},backToPreviousPage:function(){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Back to previous page"),app.view[0].router.back()},txtToUrl:function(e){if(null==e)return"";var t=new RegExp(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi);try{var o=e.match(t)}catch(t){return e}return o?(o.forEach((function(t){e=e.replace(t,'<a class="link external" data-rel="external" target="_blank" rel="noopener" href="'+t+'">'+o+"</a>")})),e):e},isSafari:function(){var e=navigator.userAgent.toLowerCase();if(-1!=e.indexOf("safari"))return!(e.indexOf("chrome")>-1)},timeDiff:function(e,t){var o=6e4,i=36e5,r=864e5,a=30*r,n=365*r,l=e-t;return l<o?0==Math.round(l/1e3)?"now":Math.round(l/1e3)+" seconds ago":l<i?Math.round(l/o)+" minutes ago":l<r?Math.round(l/i)+" hours ago":l<a?Math.round(l/r)+" days ago":l<n?Math.round(l/a)+" months ago":Math.round(l/n)+" years ago"},showAlert:function(e){app.dialog.alert(thoriumCorePlugin.txtToUrl(e))},showNotification:function(e,t,o,i,r){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Show Notification"),t=t||3e3,o=o||"bell_fill",r=r||"",app.notification.create({icon:'<i class="f7-icons text-muted">'+o+"</i>",title:"NOTIFICATION",closeButton:!1,titleRightText:"",subtitle:r,text:e,closeTimeout:t,swipeToClose:!0,cssClass:i}).open()},showToast:function(e,t,o,i,r){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Showing Toast Message"),"boolean"!=typeof t&&(t=!1),o=o||"bottom",i=i||3e3,((r=r||null)?app.toast.create({icon:r?'<i class="f7-icons">'+r+"</i>":null,text:e,position:o,destroyOnClose:!0,closeTimeout:i}):app.toast.create({text:e,closeButton:t,closeButtonText:"OK",closeButtonColor:"text-color-white",position:o,destroyOnClose:!0,closeTimeout:i})).open()},openPopup:function(e){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Open Popup"),app.popup.create({content:e}).open()},getVlTemplateHeight:function(e,t){var o,i=e.querySelector(".virtuallist-template");if(!(o=i?i.innerHTML:$("#"+e.id).data("template"))||0==o.length)return thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] Unable to get Template for Repeater with id ["+e.id+"]"),void app.preloader.hide();var r=e.offsetWidth;o=o.replace("url({{productimage}})","url('./img/defaultimg.png')");var a=document.createElement("div");r>0&&(a.style.width=r+"px");var n=e.classList.value;a.innerHTML=t>1?'<div class="'+n+' row no-gap multicol w-100 temptemplate">'+o+"</div>":'<div class="'+n+' w-100 temptemplate"><ul>'+o+"</ul></div>",document.getElementById("app").appendChild(a);var l=a.offsetHeight;-5==l&&(l=0),a.remove(),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Calculating Template Line Height ("+t+" columns) for Repeater with ID: ["+e.id+"] => ["+l+"px]");var u="tmp-"+e.id,c=document.getElementById(u);c&&c.parentNode&&c.parentNode.removeChild(c);document.getElementsBy;var d=document.createElement("style");return d.id=u,d.innerHTML="#"+e.id+" li {height:"+l+"px !important;}",document.getElementsByTagName("HEAD")[0].appendChild(d),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Template Line Height ("+t+" columns) Applied for Repeater with ID: ["+e.id+"] => ["+l+"px]"),l||0},renderVirtualListFromData:function(e,t,o){var i=1;i=window.innerWidth>=768?e.getAttribute("data-col-count-tablet")||1:e.getAttribute("data-col-count")||1,t||thoriumCorePlugin.logEvent(1,"[com.thoriumbuilder.core] renderVirtualListFromData initialized with null items"),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Rendering Repeater Virtual List ["+t.length+" rows]");var r,a=!0,n=thoriumCorePlugin.getVlTemplateHeight(e,i);i>1&&(a=!1),(r=app.virtualList.get(e))&&app.virtualList.destroy(r);var l=(r=app.virtualList.create({el:e,items:t,createUl:a,cols:i,setListHeight:!0,rowsBefore:10,rowsAfter:10,emptyTemplate:thoriumCorePlugin.emtyResultTemplate,searchAll:function(e,t){for(var o=[],i=0;i<t.length;i++){(JSON.stringify(t[i]).toLowerCase().indexOf(e.toLowerCase())>=0||""===e.trim())&&o.push(i)}return o},itemTemplate:o,height:n})).$el[0];l&&(l.setAttribute("data-loaded",!0),l.setAttribute("data-count",t.length)),app.preloader.hide()},renderVirtualMediaListData:function(e,t){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Rendering Virtual List Data");var o=e.getAttribute("data-template")||null;if(!o)return $("#"+e.id).hide(),thoriumCorePlugin.logEvent(1,"[com.thoriumbuilder.core] No template defined"),void thoriumCorePlugin.showAlert("[com.thoriumbuilder.core] No template defined");var i=e.getAttribute("data-height-ios")||104,r=e.getAttribute("data-height-md")||111,a=app.virtualList.create({el:e,items:t,createUl:!0,setListHeight:!0,searchAll:function(e,t){for(var o=[],i=0;i<t.length;i++){(JSON.stringify(t[i]).toLowerCase().indexOf(e.toLowerCase())>=0||""===e.trim())&&o.push(i)}return o},itemTemplate:o,height:"ios"===app.theme?i:"md"===app.theme?r:111}).$el[0];a&&(a.setAttribute("data-loaded",!0),a.setAttribute("data-count",t.length))},getVirtualMediaListData:function(e,t){var o=[],i=$("#"+e.id);if(i){var r=app.virtualList.get(i);r&&app.virtualList.destroy(r);var a="js/json/"+t;thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Loading Virtual List Data from Json at ["+a+"]"),app.preloader.show(),fetch(a,{method:"get",headers:{"Content-type":"application/json"}}).then((function(t){t.json().then(t=>{thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Received Data from ["+a+"]");var i=0,r={};for(var n in t)(r=t[n]).dataindex=i,i+=1,o.push(r);thoriumCorePlugin.renderVirtualMediaListData(e,o),app.preloader.hide()}).catch((function(t){$("#"+e.id).hide(),thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] Error ["+t.message+"] While loading data from ["+a+"]"),thoriumCorePlugin.showAlert(t.message)}))})).catch((function(t){$("#"+e.id).hide(),app.preloader.hide(),thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] Error ["+t.message+"]"),0==app.online?thoriumCorePlugin.showNotification("Internet connection lost"):app.dialog.alert(t.message)}))}},initVirtualMediaLists:function(){$(".virtual-media-list").each((function(e,t){if("true"!=t.getAttribute("data-loaded")&&"true"==t.getAttribute("data-virtual-list")){app.preloader.show();var o=$(this).attr("data-json-source")||null;o&&thoriumCorePlugin.getVirtualMediaListData(t,o)}}))},ISO8601:function(e){var t=e.getDate();t<10&&(t="0"+t);var o=e.getMonth()+1;return o<10&&(o="0"+o),e.getFullYear()+"-"+o+"-"+t},getTime:function(e){var t="",o=e.getHours();1==kHours12&&(o>12?(o-=12,t="pm"):t="am"),o<10&&(o="0"+o);var i=e.getMinutes();return i<10&&(o="0"+i),(o+":"+i+" "+t).trim()},geolocation:function(e){if(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Trying to geolocate user..."),navigator.geolocation)try{navigator.geolocation.getCurrentPosition((function(t){e.value=t.coords.latitude+","+t.coords.longitude,$("#"+e.id).data("pos",t),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] User Geolocated "+t.coords.latitude+","+t.coords.longitude)}),(function(t){thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] "+t.message),e.value=t.message}))}catch(e){thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] "+e.message),thoriumCorePlugin.showAlert(e.message)}else thoriumCorePlugin.logEvent(1,"[com.thoriumbuilder.core] Geolocation is not supported."),e.value="Geolocation is not supported."},fillSelect:function(e,t,o,i,r){"true"!=e.getAttribute("data-loaded")&&($("#"+e.id).addClass("disabled"),app.preloader.show(),"2"==i?"object"==typeof firestorePlugin&&firestorePlugin.initFormSelectWithCollection(e,t,o):(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Calling Api  ["+t+"]"),app.request.promise.json(t).then((function(t){if(t.status&&200!==t.status)app.preloader.hide(),$("#"+e.id).css("outline","1px solid red"),app.emit("dataloadError",$(this)),thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] Form Select Api Error ["+jsonresponse.status+"]"),thoriumCorePlugin.showAlert("Error "+jsonresponse.status);else{app.preloader.hide();var i=t.data;thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Form Api received Response ["+i+"]"),app.emit("dataloadSuccess",e);var a='<option value="" disabled>...</option>';for(var n in r=r||o,i)a=a+'<option value="'+i[n][r]+'">'+i[n][o]+"</option>";e.innerHTML=a;var l=e.getAttribute("data-value")||"";if(l.length>0){var u=$(e).closest(".smart-select");if(u){var c=app.smartSelect.get(u);c&&c.setValue(l)}else e.value=l}$("#"+e.id).removeClass("disabled"),e.setAttribute("data-loaded","true"),setTimeout((function(){app.preloader.hide()}),1e3)}})).catch((function(t){app.preloader.hide(),thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] Form Select Api Error ["+t.message+"]"),$("#"+e.id).css("outline","1px solid red"),app.emit("dataloadError",$(this)),thoriumCorePlugin.showAlert("Unable to call Webservice. "+t.message)}))))},initForm:function(e){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Initializing Form with id ["+e.id+"]"),$("#"+e.id+" input[data-autofill='true']").each((function(e,t){var o=t.getAttribute("type");0==t.value.length&&("date"==o&&(t.value=thoriumCorePlugin.ISO8601(new Date)),"time"==o&&(t.value=thoriumCorePlugin.getTime(new Date)),"datetime-local"==o&&(t.value=thoriumCorePlugin.ISO8601(new Date)+" "+thoriumCorePlugin.getTime(new Date)),"geo"==o&&thoriumCorePlugin.geolocation(t),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Form Input ["+t.name+"] with attribute AutoFill initialized with value ["+t.value+"]"))})),$("#"+e.id+" select[data-api-mode]").each((function(e,t){var o=t.getAttribute("data-api")||null,i=t.getAttribute("data-api-field")||null,r=t.getAttribute("data-select-collection")||null,a=t.getAttribute("data-api-fieldid")||null,n=0;n=t.getAttribute("data-api-mode")||"0",o&&"0"==n&&(n=1),"1"==n&&o&&i?(thoriumCorePlugin.fillSelect(t,o,i,n,a),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Form Input ["+t.name+"] of type Select initialized from api ["+o+"]")):"2"==n&&r&&i&&(setTimeout((function(){thoriumCorePlugin.fillSelect(t,r,i,n,a)}),100),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Form Input ["+t.name+"] of type Select initialized from api ["+o+"]"))}))},initForms:function(){1==thoriumCorePlugin.isLocal()&&$(".form-img-add-btn").hide(),$(".form").each((function(e,t){thoriumCorePlugin.initForm(t)}))},submitForm:function(e,t){var o=e.target;if(0!=app.input.validateInputs(o)){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Submiting Form with id ["+o.id+"]");var i=t.attr("data-mode")||null;if(0==i||1==i||2==i){e.preventDefault;var r=t.attr("data-form-message");if(1==thoriumCorePlugin.isLocal()&&0==i)return t[0].reset(),r.length>0&&thoriumCorePlugin.showAlert(r),thoriumCorePlugin.logEvent(1,"[com.thoriumbuilder.core] This Form can't send an email when running from the simulator"),void thoriumCorePlugin.showNotification("This Form can't send an email when running from the simulator");thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Formating Data for Form with id ["+o.id+"]");for(var a,n,l,u,c=new FormData,d=0;d<o.length;d++){const e="_alias",t=["name"+e,"id"+e,"description"+e,"this"+e,"title"+e,"submit"+e];var s=o[d].name;if(!0===t.includes(s)&&(s=s.replaceAll(e,"")),"radio"==o[d].type)!0===o[d].checked&&c.append(s,o[d].value);else if("checkbox"==o[d].type)c.append(s,o[d].checked);else if("submit"==o[d].type);else if("file"==o[d].type){var m=o[d].id,p=$("#"+m);if(p){var h=p.data("data-blob");p.data("data-filename");c.append(s,h)}}else c.append(s,o[d].value)}if(2==i){var g=t.attr("data-form-function");if(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Calling Function ["+g+"] for Form with id ["+o.id+"]"),g){var f=window[g],v=[o,c];if("function"==typeof f){f.apply(this,v);app.preloader.hide(),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Function ["+g+"] Called for Form with id ["+o.id+"]"),r.length>0&&thoriumCorePlugin.showAlert(r)}else{app.preloader.hide();var C='[com.thoriumbuilder.core] An error occured "'+g+'" is not an existing function';thoriumCorePlugin.logEvent(2,C),thoriumCorePlugin.showAlert(C),app.emit("userFormError",C,o,0,null)}}return}if(0==i){var b=t.attr("data-email")||null;if(!b){C="Recipient email not set for the form";return thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] Error: ["+C+"] when submitting Form with id ["+o.id+"]"),thoriumCorePlugin.showAlert(C),void app.emit("userFormError",C,o,0,null)}w=thoriumCorePlugin.httpRoot+"forms/form.php";var P=t.attr("data-email-title");c.append("form_email",b),c.append("form_title",P),a=c,n="POST",l="multipart/form-data",u=!0,thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Set Data for Form with id ["+o.id+"]")}else{var w,E=t.attr("data-api-data-mode")||0,A=t.attr("data-api-root")||"",k=t.attr("data-api-header")||"";if(!(w=t.attr("data-api-url"))){C="form url not defined!";return thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] Error: ["+C+"] when submitting Form with id ["+o.id+"]"),thoriumCorePlugin.showAlert(C),void app.emit("userFormError",C,o,0,null)}const e=t.attr("data-parent-key")||null;var y;if(e&&(w=w.replaceAll("{key}",e)),0==E)a=c,l="multipart/form-data",u=!0;else A.length>0?(y={[A]:{}},c.forEach((function(e,t){y[A][t]=e}))):(y={},c.forEach((function(e,t){y[t]=e}))),a=JSON.stringify(y),l="application/json",u=!1;n=t.attr("data-api-method")||"POST"}thoriumCorePlugin.logEvent(0,"Sending Data to: ["+w+"] from Form with id ["+o.id+"]"),app.request({url:w,data:a,method:n,crossDomain:!1,contentType:l,headers:k,timeout:0,processData:u,beforeSend(){app.preloader.show()},error(e,i){app.preloader.hide();var r=t.attr("data-form-error-message")||"",a=(e.responseText+" "+e.statusText).trim();thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] Form Error: ["+a+"] when submitting Form with id ["+o.id+"]"),r.length>0?thoriumCorePlugin.showAlert(r):thoriumCorePlugin.showAlert("An error occured ["+e.responseText+" "+e.statusText+"] when submitting Form with id ["+o.id+"]"),app.emit("userFormError",a,o,i,e)},success(i,a,n){app.preloader.hide(),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Form with id ["+o.id+"] Sent with Success"),r.length>0&&thoriumCorePlugin.showAlert(r),app.emit("userFormSuccess",i,o,a,n),"true"==(t.attr("data-reset-form")||"false")&&(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Form Reset"),e.target.reset(),$("#"+e.target.id+" .text-editor").each((function(e,t){var o=app.textEditor.get("#"+t.id);o&&o.setValue("")})),$(".firebase_document_preview").css("background-image",""),$(".input-filename span").html(""),$(".firebase_fileupload-rotate").hide(),$(".firebase_fileupload-remove").hide(),$(".input-filename i").hide());var l=t.attr("data-form-postprocess")||0;0==l?thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Form Sent"):1==l?(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Going Back to Previous Page"),thoriumCorePlugin.backToPreviousPage()):2==l&&(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Reloading Home Page"),thoriumCorePlugin.reloadHomePage());var u=t.attr("data-return-function")||null;if(u){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Form with id ["+o.id+"] : Calling JS function ["+u+"]");var c=window[u],d=[o,i,a,n];if("function"==typeof c){c.apply(this,d);app.preloader.hide(),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] JS function ["+u+"] called successfully when submitting Form with id ["+o.id+"]")}else{app.preloader.hide();var s='An error occured "'+u+'" is not an existing function';thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] JS function ["+u+"] called with Error: ["+s+"] when submitting Form with id ["+o.id+"]"),thoriumCorePlugin.showAlert(s),app.emit("userFormError",s,o,a,n)}}}})}}else thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Missing Mandatory fields for Form with id ["+o.id+"]")},getPhotoBrowserNavbar:function(){return'<div class="navbar navbar-photo-browser">                 <div class="navbar-bg"></div>                 <div class="navbar-inner navbar-inner-centered-title">                   <div class="left">                     <a class="link webshare" data-webshare-textref="" data-webshare-imgref=".swiper-slide-active .swiper-zoom-container img" >                         <i class="fa material-icons">share</i>                     </a>                   </div>                   <div class="title">                     <span class="photo-browser-current"></span>                     <span class="photo-browser-of">/</span>                     <span class="photo-browser-total"></span>                   </div>                   <div class="right">                     <a class="link popup-close" data-popup=".photo-browser-popup">                       <span>'+kPhotoBrowserBackLinkText+"</span>                     </a>                   </div>                 </div>               </div>"},showPhotoBrowser:function(e,t){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Show Photo Browser"),t=t||0;var o=e.length>1,i=null;1==kWebShareApi&&(i=thoriumCorePlugin.getPhotoBrowserNavbar);var r=app.photoBrowser.create({swipeToClose:!0,photos:e,backLinkText:kPhotoBrowserBackLinkText,navbarOfText:"/",theme:kPhotoBrowserTheme,captionsTheme:kPhotoBrowserTheme,navbar:!0,toolbar:o,type:"standalone",lazyLoading:!0,captionTemplate:"title",navbarTemplate:"title",renderNavbar:i,swiper:{effect:kPhotoBrowserEffect,kPhotoBrowserAutoPlay:kPhotoBrowserAutoPlay,grabCursor:!0,spaceBetween:20,speed:300,loop:!1,preloadImages:!1,zoom:{enabled:!0,maxRatio:3,minRatio:1},lazy:{enabled:!1}}});r.open(t),app.emit("photobrowserDisplayed",r)},getObjectViewPortPercent:function(e,t){var o=$("#"+e.id),i=o.offset().top,r=i+o.outerHeight(),a=t+$(window).height();Math.round(100*(r-$(window).scrollTop())/($(window).height()+o.height()));return parseInt(Math.round((a-i)/o.outerHeight()*100))},applyEffect:function(e){if("false"==(e.getAttribute("data-effect-loaded")||"false")){var t=e.getAttribute("data-transform-effect")||"";e.style.transform=t;var o=e.getAttribute("data-transform-opacity")||"";e.style.opacity=o,thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Apply Effect to element "+e.id+" ["+t+"]"),e.setAttribute("data-effect-loaded","true")}},resetEffect:function(e){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Remove Effect from element "+e.id);var t=e.getAttribute("data-stored-state")||"";e.style.transform=t;var o=e.getAttribute("data-initial-opacity")||"";e.style.opacity=o},scrolleffectsHandler:function(e){const t=document.querySelectorAll("* [data-transform-trigger='viewport']:not(.activeeffect)");for(var o=0;o<t.length;o++){var i=t[o];if(thoriumCorePlugin.getObjectViewPortPercent(i,e.scrollTop)>(i.getAttribute("data-transform-viewport")||0)){i.classList.add("activeeffect");var r=i.getAttribute("data-transform-effect")||"";i.style.transform=r;var a=i.getAttribute("data-transform-opacity")||"";i.style.opacity=a}}},initEffects:function(){$("* [data-transform-trigger='pageload']").each((function(e){thoriumCorePlugin.applyEffect(this)}))},setStyle:function(){kCustomColor&&(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Apply Custom Color "+kCustomColor),document.documentElement.style.setProperty("--f7-theme-color",kCustomColor))},initializeServiceWorker:function(){"serviceWorker"in navigator&&"file:"!=window.location.protocol?navigator.serviceWorker.controller?thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Thorium Service worker found"):navigator.serviceWorker.register("OneSignalSDKWorker.js",{scope:"./"}).then((function(e){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Thorium Service worker registered for scope:"+e.scope)})).catch((function(e){$("#"+field.id).hide(),thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] Error ["+e.message+"] While loading oneSignal Service Worker"),thoriumCorePlugin.showAlert(e.message)})):thoriumCorePlugin.logEvent(1,"[com.thoriumbuilder.core] No Service Worker Support on this Device");var e=window.OneSignal||[];e.push((function(){e.init({appId:kOneSignalAppId})})),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] One Signal Plugin Initialization with ID ["+kOneSignalAppId+"]")},webShare:function(e,t){if(e.preventDefault(),null==navigator.share)thoriumCorePlugin.logEvent(1,"[com.thoriumbuilder.core] Web Share only possible with https web sites"),thoriumCorePlugin.showAlert("Web Share only possible with https web sites");else{var o=t.attr("data-webshare-title")||app.name,i="",r=t.attr("data-webshare-imgref");r&&(i=$(r).attr("src")||"");var a="";a=i?o:t.attr("data-webshare-textref")||window.location.href,thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Call Navigator.share"),navigator.share({title:o,url:i,text:a})}},showImageZoom:function(e){e.preventDefault,thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Show Photo Browser");var t=e.target;if(t){var o=[],i=t.getAttribute("src"),r=t.getAttribute("title");if(!i){if((i=t.style.backgroundImage).indexOf(",")>-1){var a=i.substring(0,i.indexOf(","));i=a}i=i.replace("url(","").replace(")","").replace(/\"/gi,"")}var n={};n.url=i,n.caption=r,o.push(n),thoriumCorePlugin.showPhotoBrowser(o,0)}},showCollectionZoom:function(e,t){var o;thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Show Collection Photo Browser");var i=[],r=0,a=e.find(".collection-item-image");if(a){t.view;o=a.attr("data-file")}var n=e.closest(".collection");if(n){n.children(".collection-item:not(.templaterow)").each((function(e,t){var a=n.find("#"+t.id).find(".collection-item-image");if(a){var l={};l.url=a.attr("data-file"),l.caption=a.attr("title"),i.push(l),a.attr("data-file")==o&&(r=e),e=e++}}))}thoriumCorePlugin.showPhotoBrowser(i,r)},showPopover:function(e){e.preventDefault,thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Show Popover");var t=e.target.getAttribute("data-content");t&&app.popover.create({targetEl:e.target,content:'<div class="popover"><div class="popover-inner">'+t+"</div></div>"}).open()},findGetParameter:function(e){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Get URL Parameters");var t=null,o=[];return location.search.substr(1).split("&").forEach((function(i){(o=i.split("="))[0]===e&&(t=decodeURIComponent(o[1]))})),t},translate:function(e,t){var o=document.documentElement.lang||"en";document.documentElement.dir;e||(e=sessionStorage.getItem("thorium.language")||o),t||"undefined"==(t=sessionStorage.getItem("thorium.direction"))&&(t=thoriumCorePlugin.direction),"undefined"==e&&(e=o),t=t||"ltr",document.documentElement.dir=t,thoriumCorePlugin.language=e,thoriumCorePlugin.direction=t,sessionStorage.setItem("thorium.language",e),sessionStorage.setItem("thorium.direction",t),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Translate Screen to "+e),thoriumCorePlugin.multilingual=!0;var i="data-translate-"+e;$("* ["+i+"]").each((function(e){var t=$(this).length,o=$(this).attr(i);o.length>0&&(1==t?$(this).html(o):$(this).text(o))}))},pullToRefreshHandle:function(e){var t,o=$(".ptr-content");e&&(t=e.detail.route.query.key||null),o.on("ptr:refresh",(function(e){0==thoriumCorePlugin.isLoading&&(thoriumCorePlugin.isLoading=!0,thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Call to 'Pull to Refresh'"),setTimeout((function(){var i=e.target.getAttribute("data-ptr-repeater");$("#"+i).hasClass("firebase-virtual-list-content")&&($("#"+i).attr("data-loaded","false"),"object"==typeof firestorePlugin&&firestorePlugin.firebase_initFirebaseVirtualLists(!1,t)),$("#"+i).hasClass("json-virtual-list-content")&&($("#"+i).attr("data-loaded","false"),"object"==typeof jsonApiPlugin&&jsonApiPlugin.initAllRepeaters(t)),o.removeClass("ptr-pull-up"),o.removeClass("ptr-transitioning"),o.removeClass("ptr-refreshing"),thoriumCorePlugin.isLoading=!1}),1e3))}))},addToHomeScreen:function(){if(!(0==kAddToHomeScreenIos&&1==app.device.ios||0==kAddToHomeScreenMd&&1==app.device.android)){var e;e=1==app.device.ios?(e=kAddToHomeScreenIosText).replaceAll("#ICON",'<i class="fa f7-icons">square_arrow_up</i>'):(e=kAddToHomeScreenMdText).replaceAll("#ICON",'<span class="fa material-icons">more_vert</span>');var t='<div class="sheet-modal addtohomescreen"><div class="sheet-modal-inner"><p class="ahs-title font-weight-bold">'+kAddToHomeScreenTitle+"</p><p>"+e+"</p>";1==kSkipButton&&(t=t+'<p><a class="link sheet-close">'+kSkipButtonText+"</a></p>"),t+='<p class="ios-only"><i class="fa f7-icons">chevron_down</i></p></div></div>',app.sheet.create({swipeToClose:!1,backdrop:!0,content:t}).open(!0)}},initialize:function(){if(1==app.initialized){var e=$(".apploader");e&&app.preloader.showIn(e),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Initializing App.."),thoriumCorePlugin.translate(),kOneSignalAppId.length>0&&thoriumCorePlugin.initializeServiceWorker(),0!=thoriumCorePlugin.isLocal()||0!=kDesktopAllowed||!app.device.desktop&&Framework7.support.touch&&(app.device.android||Framework7.device.ios)?(1==app.device.desktop&&thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] App is running in Desktop mode"),1==Framework7.support.touch&&thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Touch support detected"),1==app.device.android&&thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Android Device detected"),1==app.device.ios&&thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] iOS Device detected"),1==app.device.cordova?thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] App is running in Native Hybrid mode"):1==app.device.webView&&thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] App is installed to Home Screen"),1==kHybridAppsLog&&thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Debug Log is activated"),1==app.device.cordova?(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.sqlite] App is running in Native Hybrid mode, set DB host to ["+kRemoteHost+"]"),thoriumCorePlugin.httpRoot=kRemoteHost):1==thoriumCorePlugin.isLocal()?(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.sqlite] App is running in Local mode, set DB host to ["+kLocalRoot+"]"),thoriumCorePlugin.httpRoot=kLocalRoot):(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.sqlite] App is running in PWA mode, set DB host to empty"),thoriumCorePlugin.httpRoot=""),1==kForceInstall&&0==app.device.webView&&"file:"!=window.location.protocol&&0==app.device.cordova&&(app.device.ios||app.device.android)&&thoriumCorePlugin.addToHomeScreen(),thoriumCorePlugin.setStyle(),kAuthMode>0?($(".apploader").show(),app.preloader.show(),$(".preloader-backdrop").addClass("opaque")):$(".apploader").hide(),thoriumCorePlugin.initAllSwipers(),thoriumCorePlugin.initForms(),thoriumCorePlugin.initVirtualMediaLists(),thoriumCorePlugin.initAllTextEditors(),thoriumCorePlugin.initAllCalendars(),thoriumCorePlugin.initAllTimePickers(),thoriumCorePlugin.pullToRefreshHandle(null),thoriumCorePlugin.resize(),1==app.device.cordova&&$(".webshare").hide(),setTimeout((function(){thoriumCorePlugin.initEffects()}),100),app.emit("appInitialised")):(thoriumCorePlugin.showToast("This App can only run on a Mobile device",!1,"center",9999999),$("#page").hide())}},resize:function(e){$(".selfscroll").each((function(e,t){var o=$(t).parents(".page-content");if(o){var i=o.height()-$(".selfscroll").offset().top;$(".selfscroll").css("height",i+"px"),thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Virtual List with ID ["+t.id+"] Resized to "+i+"px")}}))},initSwiper:function(e){var t=$("#"+e),o=document.getElementById(e);if(t)app.swiper.get(o)},initAllSwipers:function(){$(".swiper-container").each((function(e,t){thoriumCorePlugin.initSwiper(t.id)}))},initTextEditor:function(e){if($("#"+e.id).attr("texteditor-initialized",!0),"true"!=status)return $("#"+e.id).attr("texteditor-initialized",!0),app.textEditor.create({el:"#"+e.id,buttons:kTextEditorButtons,on:{change:function(e){var t=e.el.id+"-shadow",o=e.value.trim();document.getElementById(t).value=o},init:function(e){var t=e.el.id+"-shadow",o=e.value.trim();document.getElementById(t).value=o}}})},initAllTextEditors:function(){$(".text-editor").each((function(e,t){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Init Text Editor Instance with ID ["+t.id+"]");var o=app.textEditor.get("#"+t.id);o||(o=thoriumCorePlugin.initTextEditor(t))}))},initCalendar:function(e,t){if("true"!=$("#"+e).attr("calendar-initialized")){var o,i=app.calendar.get("#"+e);if(!i)o=1==t?kDateTimeFormat:kDateFormat,i=app.calendar.create({inputEl:"#"+e,inputReadOnly:!0,timePicker:t,timePickerFormat:{hour:"numeric",minute:"numeric"},touchMove:!1,animate:!0,backdrop:!0,closeOnSelect:!0,weekHeader:!0,monthSelector:!0,monthPicker:!0,yearSelector:!0,dateFormat:o,on:{dayClick:function(e,t,o,i,r){},change:function(e,t,o,i,r){}}}),$("#"+e).attr("calendar-initialized",!0)}},initAllCalendars:function(){("windows"==app.device.os||(navigator.platform="MacIntel")&&1==thoriumCorePlugin.isSafari())&&(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Desktop Mode detected, initializing Calendar Fallback"),$("input[type='date']").each((function(e,t){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Init Calendar Instance with ID ["+t.id+"]"),thoriumCorePlugin.initCalendar(t.id,!1)})),$("input[type='datetime-local']").each((function(e,t){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Initl Instance with ID ["+t.id+"]"),thoriumCorePlugin.initCalendar(t.id,!0)})))},initTimePicker:function(e){if("true"!=$("#"+e).attr("picker-initialized")){var t,o,i=app.picker.get("#"+e);if(!i)t=0==kHours12?[{values:function(){for(var e=[],t=0;t<=23;t++)e.push(t);return e}()},{divider:!0,content:":"},{values:function(){for(var e=[],t=0;t<=59;t++)e.push(t<10?"0"+t:t);return e}()}]:[{values:function(){for(var e=[],t=0;t<=12;t++)e.push(t<10?"0"+t:t);return e}()},{divider:!0,content:":"},{values:function(){for(var e=[],t=0;t<=59;t++)e.push(t<10?"0"+t:t);return e}()},{divider:!0,content:" "},{values:(o=[],o.push("am"),o.push("pm"),o)}],i=app.picker.create({inputEl:"#"+e,backdrop:!0,toolbarCloseText:"Done",cols:t,on:{init:function(t){var o=$("#"+e).val(),i=o.substr(0,o.indexOf(":")),r=o.substr(o.indexOf(":")+1,2),a=o.substr(o.indexOf(" ")+1,2);t.setValue([i,r,a],200)},change:function(t,o,i){var r=t.value[0]+":"+t.value[1];1==kHours12&&(r=r+" "+t.value[2]),setTimeout((function(){$("#"+e).val=$("#"+e).val(r)}),100)}}}),$("#"+e).attr("picker-initialized",!0)}},initAllTimePickers:function(){("windows"==app.device.os||(navigator.platform="MacIntel")&&1==thoriumCorePlugin.isSafari())&&(thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Desktop Mode detected, initializing Time Picker Fallback"),$("input[type='time']").each((function(e,t){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Init Picker Instance with ID ["+t.id+"]"),thoriumCorePlugin.initTimePicker(t.id)})))},logEvent:function(e,t){e=e||0,t=t||"";var o=new Date;o.getHours(),o.getMinutes(),o.getSeconds(),o.getMilliseconds();window.status="{"+e+"} "+t},loadImage:function(e,t,o){if(o=o||800,e.length>0){var i="input"==t[0].tagName.toLowerCase(),r=(e[0].size/1024/1024).toFixed(4);if(1==i&&r>kImgMaxSize||0==i&&r>kDocMaxSize)return void app.dialog.alert("File too large (Max Size Allowed: "+kImgMaxSize+"Mb)");if(i){if(!e[0].type.match(/image.*/))return void app.dialog.alert("The dropped file is not an image!");(a=new FileReader).onload=function(i){thoriumCorePlugin.resizeImage(e[0],o).then((function(o){var i=t[0].id,r=thoriumCorePlugin.dataURItoBlob(o);r.name=e[0].name,$("#"+i+"-fileinput").data("data-blob",o),$("#"+i+"-fileinput").data("data-type",r.type||"image/jpg"),$("#"+i+"-fileinput").data("data-filename",e[0].name),t.css("background-image","url("+o+")"),$("#"+t[0].id+"-rotate")&&$("#"+t[0].id+"-rotate").show(),$("#"+t[0].id+"-remove")&&$("#"+t[0].id+"-remove").show()}))},a.readAsDataURL(e[0])}else{var a;(a=new FileReader).onload=function(o){var i=t[0].id,r=a.result;$("#"+i+"-fileinput").data("data-blob",r),$("#"+i+"-fileinput").data("data-type",i.type),$("#"+i+"-fileinput").data("data-filename",e[0].name),$("#"+t[0].id+"-remove")&&$("#"+t[0].id+"-remove").show(),$("#"+t[0].id+"-fileinput-filename").css("visibility","visible"),$("#"+t[0].id+"-fileinput-filename span").text(e[0].name),$("#"+t[0].id+"-fileinput-filename i").show()},a.readAsDataURL(e[0])}}},resizeImage:function(e,t){return new Promise((function(o,i){var r="x",a=new FileReader;a.onloadend=function(){var n=new Image;n.src=a.result,n.onload=function(){var i=n.width,a=n.height;i>a?i>t&&(a*=t/i,i=t):a>t&&(i*=t/a,a=t);var l=document.createElement("canvas");l.width=i,l.height=a,l.getContext("2d").drawImage(this,0,0,i,a);var u=e.type||"image/jpg";r=l.toDataURL(u),o(r)},n.onerror=function(e){i("Image Resize Error "+e)}},a.readAsDataURL(e)}))},rotateImage:function(e,t){return new Promise((function(o,i){var r=new Image;r.src=e,r.onload=function(){var e=r.width,i=r.height,a=document.createElement("canvas");a.width=e,a.height=i;var n=a.getContext("2d");a.width=i,a.height=e,(n=a.getContext("2d")).translate(i,0),n.rotate(90*Math.PI/180),n.drawImage(this,0,0,e,i),t=t||"image/jpg",dataURL=a.toDataURL(t),o(dataURL)},r.onerror=function(e){i("Unable to rotate Image "+e)}}))},dataURItoBlob:function(e){for(var t=atob(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),r=new Uint8Array(i),a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return new Blob([i],{type:o})},uploadFile:function(e,t,o,i,r,a){var n=(t=t.replace("C:\\fakepath\\","")).substr(t.lastIndexOf(".")+1),l=firebase.storage().ref().child(o+"/");t=r+"_"+i+"."+n;var u=thoriumCorePlugin.dataURItoBlob(e);l.child(t).put(u).catch((function(e){app.preloader.hide(),app.dialog.alert(e.message)})).then((function(e){e.task.on("state_changed",(function(e){}),(function(e){app.preloader.hide(),app.dialog.alert(e.message)}),(function(){e.task.snapshot.ref.getDownloadURL().then((function(e){a.update({[r]:e}).catch((function(e){app.preloader.hide(),app.dialog.alert("Error writing Image: "+e.message)}))})).catch((function(e){app.preloader.hide(),app.dialog.alert("Error while uploading image: "+e.message)}))}))}))}};$(document).on("click","a[href^=mailto],a[href^=tel],a[href^=sms],a[href^=skype],a[href^=facetime]",(function(e){if(1==app.device.webView&&1==app.device.ios){e.preventDefault();var t=e.target.getAttribute("href");return t&&(window.location=t),!1}})),$(document).on("click",".virtual-list .link",(function(e){e.stopPropagation(),e.stopImmediatePropagation()})),$(document).on("click","input[type='geo']",(function(e){e.preventDefault();var t=$("#"+e.target.id).data("pos");if(t){var o="https://www.google.com/maps/search/?api=1&query="+t.coords.latitude+","+t.coords.longitude;window.location=o}})),$(document).on("dragenter",".firebase_document_preview , .firebase_fileupload-dropzone ",(function(e){e.preventDefault(),$(this).css("opacity","0.5")})),$(document).on("dragover",".firebase_document_preview , .firebase_fileupload-dropzone",(function(e){return e.preventDefault(),$(this).css("opacity","0.5"),!1})),$(document).on("dragleave",".firebase_document_preview , .firebase_fileupload-dropzone ",(function(e){e.preventDefault(),$(this).css("opacity","1")})),$(document).on("drop",".firebase_document_preview , .firebase_fileupload-dropzone",(function(e){e.preventDefault();var t=e.dataTransfer.files;$(this).css("opacity","1");var o=$(this).attr("data-resize")||800;thoriumCorePlugin.loadImage(t,$(this),o),e.stopPropagation()})),$(document).on("click",".firebase_document_preview, .firebase_fileupload-dropzone",(function(e){(e.preventDefault(),1==thoriumCorePlugin.isLocal()&&(app.device.ios||app.device.android))&&app.tooltip.create({targetEl:$(this),text:"Drop your file here"}).show();var t=$("#"+e.target.id+"-fileinput");t&&t.trigger("click")})),$(document).on("click",".firebase_fileupload-rotate",(function(e){e.preventDefault();var t=$(this).attr("data-fileinput-ref"),o=$("#"+t),i=$("#"+t+"-fileinput");if(o&&i){var r=i.data("data-blob"),a=i.data("data-type");app.preloader.show(),setTimeout((function(){thoriumCorePlugin.rotateImage(r,a).then((function(e){app.preloader.hide(),o.css("background-image","url("+e+")"),i.data("data-blob",e)})).catch((function(e){app.preloader.hide(),app.dialog.alert("Error image: "+e.message)}))}),500)}})),$(document).on("change",".firebase_document_input",(function(e){e.preventDefault();var t=$(this).attr("data-fileinput-ref"),o=$("#"+t),i=$(this).attr("data-resize")||800;o&&thoriumCorePlugin.loadImage(e.target.files,o,i)})),$(document).on("click",".firebase_fileupload-remove",(function(e){e.preventDefault();var t=$(this),o=t.attr("data-fileinput-ref");$("#"+o)&&app.dialog.confirm("Remove file?",(function(){$("#"+o+"-fileinput").data("data-blob",null),$("#"+o+"-fileinput").data("data-type",null),$("#"+o).attr("data-clear",!0),$("#"+o+"-fileinput").data("data-filename",null),$("#"+o+"-fileinput-filename").css("visibility","hidden"),$("#"+o+"-fileinput-filename span").text(""),$("#"+o+"-fileinput-filename i").hide(),$("#"+o).css("background-image",""),$("#"+o+"-rotate")&&$("#"+o+"-rotate").hide(),t.hide()}))})),$(document).on("mousedown","input[readonly]",(function(e){e.preventDefault()})),$(document).on("submit",".form",(function(e){thoriumCorePlugin.submitForm(e,$(this))})),$(document).on("click",".form-submit-button",(function(e){var t=$(this).attr("data-form")||"",o=$("#"+t);o&&o.length>0&&o.trigger("submit")})),$(document).on("click",".webshare",(function(e){thoriumCorePlugin.webShare(e,$(this))})),$(document).on("click",".img-zoom",(function(e){thoriumCorePlugin.showImageZoom(e),e.stopPropagation(),e.stopImmediatePropagation()})),$(document).on("click",".collection-item-zoom",(function(e){thoriumCorePlugin.showCollectionZoom($(this),e)})),$(document).on("click",".card-opened",(function(e){e.preventDefault,app.card.close($(this),!0)})),$(document).on("click",".dynamic-popover",(function(e){thoriumCorePlugin.showPopover(e)})),$(document).on("click",".segmented .button",(function(e){$(this).closest(".segmented").children(".button-active").removeClass("button-active");$(this).addClass("button-active")})),$(document).on("page:afterin",(function(e){var t=e.detail;thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Page "+t.name+" is loaded")})),$(document).on("mouseover","* [data-transform-trigger='mouseover']",(function(e){thoriumCorePlugin.applyEffect(this)})),$(document).on("mouseout","* [data-transform-trigger='mouseover']",(function(e){thoriumCorePlugin.resetEffect(this)})),$(document).on("click","* [data-transform-trigger='mouseclick']",(function(e){var t=$(this).attr("data-transform-effect")||"";this.style.transform=t})),document.addEventListener("scroll",(function(e){var t=e.target;thoriumCorePlugin.scrolleffectsHandler(t)}),!0),$(document).on("click","* [data-translate-language]",(function(e){var t=e.target.getAttribute("data-translate-language")||null,o=e.target.getAttribute("data-translate-direction")||null;thoriumCorePlugin.translate(t,o)})),app.on("offline",(function(){thoriumCorePlugin.logEvent(1,"[com.thoriumbuilder.core] Internet connection lost")})),app.on("online",(function(){thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Internet connection back")})),$(document).on("page:afterin",".page",(function(e,t){1==app.device.cordova&&$(".webshare").hide(),1==app.device.cordova&&1==app.device.ios&&($(".page-current .page-content").css("overflow-y","hidden"),setTimeout((function(){$(".page-current .page-content").css("overflow-y","auto")}),200)),thoriumCorePlugin.initEffects()})),$(document).on("page:beforeout",(function(e){var t=e.detail;thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Page "+t.name+" will close"),$(".custominfowindow").hide()})),$(document).on("page:beforein",(function(e){var t=e.detail;thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Page "+t.name+" will open"),$(".custominfowindow").hide(),1==kAutoClosePanels&&(app.panel.get("#panel-left").close(!0),app.panel.get("#panel-right").close(!0))})),$(window).on("resize",(function(e){thoriumCorePlugin.resize()})),$(document).on("page:mounted",(function(e){var t=e.detail;thoriumCorePlugin.logEvent(0,"[com.thoriumbuilder.core] Page "+t.name+" is mounted"),thoriumCorePlugin.translate(),1==kFillMode&&$(".navbar").css("background-color","var(--f7-theme-color)"),thoriumCorePlugin.initAllSwipers(),thoriumCorePlugin.initForms(),thoriumCorePlugin.initVirtualMediaLists(),thoriumCorePlugin.pullToRefreshHandle(e),thoriumCorePlugin.initAllTextEditors(),thoriumCorePlugin.initAllCalendars(),thoriumCorePlugin.initAllTimePickers()})),window.onerror=function(e,t,o){return thoriumCorePlugin.logEvent(2,"[com.thoriumbuilder.core] An error occured: "+e+"url="+t+" line"+o),!1},document.addEventListener("deviceready",thoriumCorePlugin.initialize),document.addEventListener("DOMContentLoaded",thoriumCorePlugin.initialize);